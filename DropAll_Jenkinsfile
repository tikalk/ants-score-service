properties([buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '', numToKeepStr: '5')), disableConcurrentBuilds()])

node {
    def workspace = pwd()
    try {
        stage ('Drop All') {
            sh "aws logs delete-log-group --log-group-name /aws/lambda/Ants-Smashing-GetPlayersScores"
            sh "aws logs delete-log-group --log-group-name /aws/lambda/Ants-Smashing-PostHitTrial"
            sh "aws logs delete-log-group --log-group-name /aws/lambda/Ants-Smashing-ProcessKinesisHitTrialEvents"
            sh "aws dynamodb delete-table --table-name Ants-Smashing-PlayersScore"
            sh "aws dynamodb delete-table --table-name Ants-Smashing-smashedAnts"
            sh "aws kinesis delete-stream --stream-name Ants-Smashing-HitTrials"
            sh "aws lambda delete-function --function-name Ants-Smashing-GetPlayersScores"
            sh "aws lambda delete-function --function-name Ants-Smashing-PostHitTrial"
            sh "aws lambda delete-function --function-name Ants-Smashing-ProcessKinesisHitTrialEvents"
      	}
    } catch (err) {
        currentBuild.result = 'FAILED'
        throw err
    }

}